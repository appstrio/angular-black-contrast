/**
 * angular-black-contrast
 * @version v0.0.1 - 2014-03-10
 * @link https://github.com/appstrio/angular-black-contrast
 * @author Gilad Peleg <giladp007@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module("aio.image.black-contrast",[]),angular.module("aio.image.black-contrast").factory("aioBlackContrast",["$q","$rootScope",function(a,b){"use strict";var c=function(a){var b=2.2,c=.2126*Math.pow(a.red/100,b)+.7152*Math.pow(a.green/100,b)+.0722*Math.pow(a.blue/100,b);return c>.5},d=function(a,b,c){var d,e;for(d=0;a>d;d++)for(e=0;b>e;e++)c(d,e)},e=function(a,b,c){var e={},f=0,g=0,h=0,i=0;return d(c,b,function(c,d){var e=4*(c*b+d),j=a[e],k=a[e+1],l=a[e+2];f++,g+=j/255*100,h+=k/255*100,i+=l/255*100}),e.red=Math.floor(g/f),e.green=Math.floor(h/f),e.blue=Math.floor(i/f),e},f=function(a,b,d){var f=e(a.data,b,d);return c(f)},g=function(c,d){var e,g=a.defer();return d="undefined"!=typeof d?d:!0,e=new Image,e.onload=function(){var a=document.createElement("canvas"),c=a.getContext("2d");a.width=e.width,a.height=e.height,c.drawImage(e,0,0);var d=c.getImageData(0,0,e.width,e.height),h=f(d,e.width,e.height);b.$apply(function(){g.resolve(h)})},e.onerror=function(a){b.$apply(function(){g.reject(a)})},d&&(e.crossOrigin="anonymous"),e.src=c,g.promise};return{contrastFromUrl:g,contrastFromImageData:f}}]);